# 要件定義書 - Electron App Factory Agent

作成日: 2026-01-04
ステータス: ドラフト
承認状況: 承認済み

---

## 1. 概要

### 1.1 エージェント情報
- ドメイン名: electron_app_factory
- 表示名: Electron App Factory Agent
- 説明: Electronでアプリを大量に作成・更新・ビルドするためのエージェント。アプリごとに成果物（コード/仕様/ビルド成果）を分離して保存し、反復開発を加速する。

### 1.2 解決する課題
- Electronの初期セットアップ（Main/Renderer/Preload、IPC、安全設定）に時間がかかる
- 似たアプリを何度も作る際、テンプレートと共通部品の再利用ができず手戻りが発生
- アプリごとに成果物が散らばり、どれが最新版か追えない
- パッケージング/配布（Windows: msi/exe, macOS: dmg）の設定がアプリごとにブレる

### 1.3 対象ユーザー
- **主な利用者**: Electronでツールを量産したい開発者
- **経験レベル**: 初級〜中級（Electron経験が浅くても可）
- **利用頻度**: アプリ量産・PoC・社内ツール開発のたび

### 1.4 成功基準・KPI
- 新規Electronアプリ雛形生成を10分以内
- セキュリティ推奨設定（`contextIsolation`等）をデフォルトで満たす
- 生成したアプリの保存・検索・更新が一貫してできる（人間が迷わない）

---

## 2. 機能要件

### 2.1 必須機能（Must Have）
| ID | 機能名 | 説明 | 優先度 |
|----|--------|------|--------|
| F-001 | アプリ雛形生成 | テンプレートに基づきElectronアプリ雛形を生成（Main/Renderer/Preload、IPC骨組み） | P1 |
| F-002 | アプリ別保存 | アプリごとに保存先を固定し、コード/仕様/ビルド成果を分離して保存する | P1 |
| F-003 | メタデータ管理 | アプリ一覧（名前、目的、技術スタック、生成日時、保存先）を台帳として管理する | P1 |
| F-004 | ビルド/配布 | Windows/macOS向けにインストーラ/配布物（`msi`/`exe`/`dmg`）を生成できる手順と設定を含める | P1 |
| F-005 | 量産ワークフロー | 複数アプリを連続生成する（同じ雛形で複数名を作る/仕様違いを作る） | P1 |

### 2.2 推奨機能（Should Have）
| ID | 機能名 | 説明 | 優先度 |
|----|--------|------|--------|
| F-101 | プリセット種類 | 「メモ」「トレイ常駐」「クリップボード」「CSVビューア」等のプリセット雛形 | P2 |
| F-102 | 共通モジュール | ログ、設定保存、更新通知、エラーハンドリング等の共通部品 | P2 |
| F-103 | 既存アプリ更新 | 既存アプリに対する機能追加・設定変更を差分で適用 | P2 |

### 2.3 将来機能（Nice to Have）
| ID | 機能名 | 説明 | 優先度 |
|----|--------|------|--------|
| F-201 | 自動テスト雛形 | E2E/スモークテスト（起動確認）を自動生成 | P3 |
| F-202 | 自動署名/Notarize | macOS/Windowsの署名・配布自動化（証明書はユーザー管理） | P3 |

---

## 3. 非機能要件

### 3.1 品質要件
- セキュリティ: Electron公式推奨（`nodeIntegration`無効、`contextIsolation`有効等）をデフォルトとする
- 再現性: 生成手順が毎回同じ結果になる（テンプレート固定・台帳で追跡）

### 3.2 制約事項
- 依存ツール（例: Node.js、npm/pnpm、Electron Forge等）は利用環境に依存（未記載/要確認）
- 署名・Notarizeは証明書が必要（初期スコープ外）

---

## 4. 保存設計（重要: aappごとに保存）

### 4.1 保存方針（確定）
- 生成アプリは `output/electron_app_factory_agent/Stock/programs/{app_slug}/` に保存する
- `{app_slug}` は英小文字+ハイフン（例: `memo-tray`）

### 4.2 ディレクトリ案（確定）
- `Stock/programs/{app_slug}/repo/` : Electronアプリのコード一式
- `Stock/programs/{app_slug}/documents/` : 仕様、要望、メモ
- `Stock/programs/{app_slug}/artifacts/` : ビルド成果（配布物）
- `Stock/programs/{app_slug}/app_meta.json` : 台帳用メタデータ（名前、目的、生成日、テンプレート等）

---

## 5. 利用シナリオ

### シナリオ1: 新規アプリを量産
1. ユーザーがアプリ名と目的を入力
2. エージェントが雛形を生成し、保存先を確定
3. 台帳に追記し、起動手順・ビルド手順を提示

### シナリオ2: 既存アプリに機能追加
1. ユーザーが対象アプリを台帳から指定
2. エージェントが差分で追加実装（IPC/画面/設定等）
3. 成果物を同一保存先に反映し、変更履歴を残す

---

## 6. 成果物フォーマット
- コード: TypeScript（React）
- 設定: `package.json`, Electron Forge設定ファイル（maker: dmg/wix/squirrel想定）
- ドキュメント: Markdown
- 台帳: MarkdownまたはJSON（未確定）

---

## 7. 未決事項（TODO）
- [ ] TODO: パッケージマネージャ（npm/pnpm/yarn） - 2026-01-04
- [ ] TODO: 保存形式（台帳をJSON固定にするか、Markdown併用するか） - 2026-01-04

---

## 8. 承認履歴
| 日時 | 承認者 | 内容 |
|------|--------|------|
| 2026-01-04 | ユーザー | 要件承認 |
| 2026-01-04 | ユーザー | 保存設計承認 |
| 2026-01-04 | ユーザー | デフォルトUI=React |
| 2026-01-04 | ユーザー | 配布形式=msi/exe/dmg（Win/macOS） |
| 2026-01-04 | ユーザー | 雛形=Electron Forge |
